<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sistema Alcohol칤metro - ESP32</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="app-container">
    <header class="app-header">
      <h1>Sistema Alcohol칤metro</h1>
      <p>Monitor en tiempo real con registro en base de datos</p>
    </header>

    <div class="dashboard">
      <!-- Panel de Control -->
      <section class="control-panel">
        <h2>Medici칩n Actual</h2>
        <div class="sensor-reading">
          <div class="value-display">
            <span id="alcoholMGL">--</span>
            <span class="unit">mg/L</span>
          </div>
          <div class="value-display secondary">
            <span id="alcoholPercent">--</span>
            <span class="unit">%</span>
          </div>
        </div>
        
        <div class="sensor-info">
          <div class="info-item">
            <label>Valor del sensor:</label>
            <span id="sensorValue">--</span>
          </div>
          <div class="info-item">
            <label>Usuario actual:</label>
            <span id="currentUser">USUARIO_01</span>
          </div>
          <div class="info-item">
            <label>Estado registro:</label>
            <span id="registroStatus" class="status-off">DETENIDO</span>
          </div>
        </div>
      </section>

      <!-- Configuraci칩n de Usuario -->
      <section class="user-panel">
        <h2>游녻 Configuraci칩n de Usuario</h2>
        <div class="input-group">
          <input type="text" id="userIdentification" placeholder="Ingrese identificaci칩n..." maxlength="20">
          <button onclick="setUserIdentification()">Establecer Usuario</button>
        </div>
      </section>

      <!-- Control de Registro -->
      <section class="registry-panel">
        <h2>Control de Registro</h2>
        <div class="button-group">
          <button id="toggleBtn" class="btn-primary" onclick="toggleRegistro()">Iniciar Registro Autom치tico</button>
          <button id="saveBtn" class="btn-secondary" onclick="saveManualReading()">Guardar Lectura Manual</button>
        </div>
        <div class="observations">
          <textarea id="observations" placeholder="Observaciones adicionales... (opcional)" rows="3"></textarea>
        </div>
      </section>

      <!-- Gesti칩n de Datos -->
      <section class="data-panel">
        <h2>Gesti칩n de Datos</h2>
        <div class="data-controls">
          <button class="btn-outline" onclick="loadReadings()">Actualizar Registros</button>
          <button class="btn-outline" onclick="exportToCSV()">Exportar CSV</button>
          <button class="btn-outline" onclick="clearLocalData()">Limpiar Datos Locales</button>
        </div>
        
        <!-- Filtros -->
        <div class="filters">
          <h3>Filtros</h3>
          <div class="filter-grid">
            <input type="text" id="filterUser" placeholder="Filtrar por usuario...">
            <input type="date" id="filterDate">
            <input type="number" id="filterMin" placeholder="Valor m칤nimo" step="0.1">
            <input type="number" id="filterMax" placeholder="Valor m치ximo" step="0.1">
          </div>
          <button onclick="applyFilters()" class="btn-filter">Aplicar Filtros</button>
        </div>

        <!-- Lista de Registros -->
        <div class="readings-list">
          <h3>Registros Guardados</h3>
          <div id="loadingMessage" class="loading">Cargando registros...</div>
          <div id="readingsContainer" class="readings-container">
            <!-- Los registros se cargar치n aqu칤 din치micamente -->
          </div>
          <div id="noDataMessage" class="no-data" style="display: none;">
            No hay registros disponibles. Active el registro autom치tico o guarde lecturas manuales.
          </div>
        </div>
      </section>
    </div>

    <!-- Notificaciones -->
    <div id="notification" class="notification hidden">
      <span id="notificationMessage"></span>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>